---
name: ai-dlp-prd
overview: 完善AI-DLP系统的产品PRD文档，涵盖产品背景、用户角色、所有核心功能的详细设计方案（包括功能描述、输入输出、业务流程、AI介入点、异常处理等），以及非功能需求、数据流图、系统架构等，输出为一份完整可落地的PRD文档。
todos:
  - id: write-prd-overview
    content: 编写PRD文档：产品背景与目标、用户角色定义、系统架构总览（含Mermaid架构图和核心数据流图）
    status: completed
  - id: write-prd-collection
    content: 编写PRD核心模块一：探针数据对接与归一化、数据处理管道（含统一事件模型定义、5类探针对接规范、流式/批式处理流程图）
    status: completed
    dependencies:
      - write-prd-overview
  - id: write-prd-ai-engine
    content: 编写PRD核心模块二：AI决策引擎6个子模块的详细设计（智能分类/语义分析/意图识别/事件研判/策略生成/自适应学习，每个含业务流程、AI介入方式、降级方案）
    status: completed
    dependencies:
      - write-prd-overview
  - id: write-prd-policy
    content: 编写PRD核心模块三：策略引擎与动作执行、管理可视化层（含策略匹配流程、动作执行规范、版本管理与审批流转、Dashboard功能清单）
    status: completed
    dependencies:
      - write-prd-ai-engine
  - id: write-prd-nonfunc
    content: 编写PRD非功能需求、数据架构、部署架构、API网关设计、附录（含性能指标/安全要求/SLA定义/数据库ER图/部署拓扑图）
    status: completed
    dependencies:
      - write-prd-collection
      - write-prd-ai-engine
      - write-prd-policy
---

## 用户需求

用户要求不写代码，而是先完善整个产品PRD文档，包含所有核心功能的具体设计方案。

## 产品概述

AI-DLP 是一套以AI大模型为核心决策引擎的新一代数据防泄漏系统。系统对接已有的DLP数据采集探针（网络探针、终端探针、云API探针、邮件探针、数据库探针），通过LLM的语义理解和推理能力，替代传统DLP中5个高度依赖人工介入的环节，实现从"规则驱动+人工审核"到"AI驱动+人工审批"的范式转变。

## 核心功能

1. **探针数据对接与归一化**：将已有5类探针上报的异构数据归一化为统一事件格式，支持流式与批式两种接入模式
2. **AI智能数据分类**：LLM自动识别敏感数据类型（身份证、银行卡、商业机密、源代码等），替代人工维护的正则规则库
3. **AI语义分析与意图识别**：理解数据传输的业务上下文语义，区分正常业务行为与潜在泄漏行为，识别用户操作意图
4. **AI策略自动生成**：根据合规要求（等保2.0、GDPR、行业法规）自动生成DLP策略规则，人工仅需审批
5. **AI事件智能研判**：自动判断告警严重程度、是否误报、生成处置建议，减少90%以上人工审核量
6. **自适应学习闭环**：收集人工处置反馈持续优化模型，自动调整分类阈值和策略参数
7. **策略引擎与动作执行**：策略匹配（规则+AI混合）、动作执行（阻断/告警/脱敏/放行）、策略版本管理与审批流转
8. **管理与可视化**：策略管理、事件中心、数据地图、审计日志、模型效果监控（准确率/误报率）

## 技术栈

本任务为产品PRD文档编写，不涉及代码实现。输出为Markdown格式的PRD文档文件，存放在项目根目录。

## 实现方案

### 整体策略

基于 `architecture.py` 中已有的6层架构设计和5个AI替代人工关键点，以及前一轮规划中已确定的技术栈（Python/FastAPI/LangChain/Kafka/Redis/Celery/PostgreSQL），编写一份完整的产品PRD文档。文档需要将架构设计转化为产品语言，为每个核心功能模块提供详细的业务流程、输入输出定义、AI介入方式、异常处理方案。

### 关键决策

1. **文档拆分**：PRD作为一个完整的Markdown文件 `PRD.md` 输出，内容量较大但保持单文件便于整体阅读和评审
2. **设计深度**：每个核心功能模块需包含业务流程图（Mermaid）、数据流说明、输入输出定义、AI介入点与方式、降级方案、异常处理
3. **架构对齐**：PRD中的系统架构图、数据流图、模块划分必须与 `architecture.py` 和前一轮规划中的技术架构保持一致
4. **非功能需求覆盖**：需明确性能指标（吞吐量/延迟）、安全要求（数据脱敏/权限控制）、可用性要求（降级策略/SLA）、可扩展性要求

## 实现注意事项

- PRD文档中的Mermaid图表需确保语法正确，可直接渲染
- 所有功能模块的设计需形成完整闭环，模块间接口需对齐
- 用户角色权限设计需贯穿各功能模块
- AI相关设计需明确置信度阈值、降级条件、人工干预触发点

## 目录结构

```
ai-dlp/
├── architecture.py          # [保留] 原有架构设计描述
└── PRD.md                   # [NEW] 完整产品需求文档。包含产品概述与目标、用户角色定义、系统架构总览、
                             #        8个核心功能模块的详细设计方案（业务流程/输入输出/AI介入方式/异常处理）、
                             #        非功能需求（性能/安全/可用性/可扩展性）、数据架构设计、部署架构、
                             #        关键业务流程图和数据流图。预计2000-3000行Markdown。
```